{%- comment -%}
  This is a required section for the Shopify Theme Store.
  It is available in the "Header" section in the theme editor.

  Theme Store required settings
  - Show announcement
  - Text: message to announce
  - Link: link of the announcement bar

  Theme Store optional settings
  - Home page only: only shows on the home page
{%- endcomment -%}
<section data-section-id="{{ section.id }}" data-section-type="header">
  {%- if section.settings.announcement_bar_enabled -%}
  <div>
    {%- if section.settings.announcement_bar_home_page_only == false or template.name == 'index' -%}
    {%- if section.settings.announcement_bar_link != blank -%}
    <a href="{{ section.settings.announcement_bar_link }}">
      {{ section.settings.announcement_bar_text | escape }}
    </a>
    {%- else -%}
    <p>{{ section.settings.announcement_bar_text | escape }}</p>
    {%- endif -%}
    {%- endif -%}
  </div>
  {%- endif -%}
  <nav class="navbar sticky-top navbar-expand-lg navbar-light justify-content-between">
    <button class="btn btn-outline-success" type="button" href="/collections/all">Store</button>
    <a class="navbar-brand m-0" href="#"
      style="transform: translateX(calc(50vw - 50% - 16px)); position: absolute;">{{ shop.name }}</a>
    <ul class="navbar-nav collapse navbar-collapse flex-grow-0">
      {% for block in section.blocks %}
      <li class="nav-item">
        <a tabindex="0" class="nav-link" id="{{ block.settings.id }}">{{ block.settings.title }}</a>
      </li>
      {% endfor %}
    </ul>
    <button class="navbar-toggler d-lg-none" type="button" data-toggle="collapse" data-target="#navbarDropdownMobile">
      <span class="navbar-toggler-icon"></span>
    </button>
  </nav>

  <div class="accordion collapse d-lg-none" id="navbarDropdownMobile">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0">
          <a class="btn btn-link collapsed" href="#">
            Cart
          </a>
        </h5>
      </div>
    </div>
    {% for block in section.blocks %}
    <div class="card">
      <div class="card-header" id="{{ block.settings.id }}Heading">
        <h2 class="mb-0">
          <button class="btn btn-link" type="button" data-toggle="collapse"
            data-target="#{{ block.settings.id }}Collapse" aria-expanded="true"
            aria-controls="{{ block.settings.id }}Collapse">
            {{ block.settings.title }}
          </button>
        </h2>
      </div>
      <div id="{{ block.settings.id }}Collapse" class="collapse" aria-labelledby="{{ block.settings.id }}Heading"
        data-parent="#navbarDropdownMobile">
        <div class="card-body">
          {{ block.settings.body }}
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</section>

{% if section.settings.logo != blank %}
  <style>
    .logo-image {
      display: block;
      max-width: {{ section.settings.logo_max_width }}px;
    }
  </style>
{% endif %}

{% schema %}
  {
    "name": "Header",
    "settings": [
      {
        "type": "header",
        "content": "Announcement bar"
      },
      {
        "type": "checkbox",
        "id": "announcement_bar_enabled",
        "label": "Show announcement",
        "default": false
      },
      {
        "type": "checkbox",
        "id": "announcement_bar_home_page_only",
        "label": "Show on home page only",
        "default": true
      },
      {
        "type": "text",
        "id": "announcement_bar_text",
        "label": "Announcement text",
        "default": "Announce something here"
      },
      {
        "type": "url",
        "id": "announcement_bar_link",
        "label": "Announcement link",
        "info": "Optional"
      },
      {
        "type": "header",
        "content": "Header"
      },
      {
        "type": "image_picker",
        "id": "logo",
        "label": "Logo image"
      },
      {
        "type": "range",
        "id": "logo_max_width",
        "min": 50,
        "max": 450,
        "step": 10,
        "unit": "px",
        "label": "Custom logo width",
        "default": 250
      },
      {
        "type": "link_list",
        "id": "menu",
        "label": "Menu",
        "default": "main-menu"
      }
    ],
    "blocks": [
      {
        "type": "dropdown",
        "name": "Dropdown",
        "settings": [
        {
            "id": "id",
            "type": "text",
            "label": "id"
          },
          {
            "id": "title",
            "type": "text",
            "label": "Title"
          },
          {
            "id": "body",
            "type": "text",
            "label": "Body"
          }
        ]
      }
    ]
  }
{% endschema %}

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "{{ shop.name }}",
  {% if section.settings.logo %}
    {% assign image_size = section.settings.logo.width | append:'x' %}
    "logo": "https:{{ section.settings.logo | img_url: image_size }}",
  {% endif %}
  "sameAs": [
    "{{ settings.social_twitter_link }}",
    "{{ settings.social_facebook_link }}",
    "{{ settings.social_pinterest_link }}",
    "{{ settings.social_instagram_link }}",
    "{{ settings.social_tumblr_link }}",
    "{{ settings.social_snapchat_link }}",
    "{{ settings.social_youtube_link }}",
    "{{ settings.social_vimeo_link }}"
  ],
  "url": "{{ shop.url }}{{ page.url }}"
}
</script>

{% if template.name == 'index' %}
  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "WebSite",
      "name": "{{ shop.name }}",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "{{ shop.url }}/search?q={search_term_string}",
        "query-input": "required name=search_term_string"
      },
      "url": "{{ shop.url }}{{ page.url }}"
    }
  </script>
{% endif %}

{% for block in section.blocks %}
  <script>
    $('#{{ block.settings.id }}').popover({
      title: '{{ block.settings.title }}',
      placement: 'bottom',
      html: true,
      trigger: 'focus'
    });
  </script>
{% endfor %}